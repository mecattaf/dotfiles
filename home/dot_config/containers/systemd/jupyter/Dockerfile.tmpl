# ═════════════════════════════════════════════════════════════════════════════
# 🐍 BLUEPRINT JUPYTER - Custom Image with AI Features
# Generated by Chezmoi - DO NOT EDIT MANUALLY
# Location: ~/.config/containers/systemd/jupyter/Dockerfile.tmpl
# ═════════════════════════════════════════════════════════════════════════════

FROM quay.io/jupyter/scipy-notebook:latest

USER root

# ═════════════════════════════════════════════════════════════════════════════
# 📦 INSTALL PROFESSIONAL FEATURES (Ansible-style)
# ═════════════════════════════════════════════════════════════════════════════

# Install nb_conda_kernels for multi-environment support
RUN conda install -c conda-forge nb_conda_kernels -y && \
    conda clean -afy

# Install notebook-intelligence for AI code completion (LiteLLM integration)
# This installs both the Python package and JupyterLab extension
RUN pip install notebook-intelligence && \
    jupyter labextension enable @notebook-intelligence/notebook-intelligence

# Verify installation
RUN jupyter labextension list

# ═════════════════════════════════════════════════════════════════════════════
# 📁 CREATE BLUEPRINT WORKSPACE
# ═════════════════════════════════════════════════════════════════════════════

RUN mkdir -p /home/jovyan/blueprint-workspace && \
    chown -R jovyan:users /home/jovyan/blueprint-workspace

# ═════════════════════════════════════════════════════════════════════════════
# 🔙 SWITCH BACK TO JUPYTER USER
# ═════════════════════════════════════════════════════════════════════════════

USER jovyan
WORKDIR /home/jovyan/blueprint-workspace

# ═════════════════════════════════════════════════════════════════════════════
# 📝 NOTES
# ═════════════════════════════════════════════════════════════════════════════
#
# This Dockerfile extends scipy-notebook with:
#   - nb_conda_kernels: Multi-environment support (conda environments as kernels)
#   - notebook-intelligence: AI code completion via LiteLLM
#
# Package Details:
#   - notebook-intelligence: Python package + JupyterLab extension
#   - Configured via environment variables (see jupyter.container.tmpl)
#   - Settings stored at ~/.jupyter/nbi/config.json
#
# Workspace:
#   - /home/jovyan/blueprint-workspace: User notebooks and data
#   - Persisted via jupyter.volume
#
# ═════════════════════════════════════════════════════════════════════════════
